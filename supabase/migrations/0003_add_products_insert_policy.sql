-- =============================================================================
-- DY Carbon – Add INSERT Policy for Products
-- 제품 등록 기능을 위한 RLS 정책 추가
-- =============================================================================

-- -----------------------------------------------------------------------------
-- 변경 사유 (Why)
-- 인증된 사용자가 제품을 등록할 수 있도록 products 테이블에 INSERT 정책을 추가합니다.
-- -----------------------------------------------------------------------------

-- -----------------------------------------------------------------------------
-- 영향도 평가 (Impact)
-- - products 테이블에 INSERT 정책 추가
-- - 인증된 모든 사용자가 제품을 등록할 수 있음
-- - 기존 SELECT 정책은 유지됨
-- -----------------------------------------------------------------------------

-- -----------------------------------------------------------------------------
-- 1. products 테이블 INSERT 정책 추가
-- -----------------------------------------------------------------------------
CREATE POLICY "products_insert_authenticated"
  ON public.products FOR INSERT
  TO authenticated
  WITH CHECK (true);

-- -----------------------------------------------------------------------------
-- 검증 쿼리 (Verification Query)
-- -----------------------------------------------------------------------------
-- SELECT schemaname, tablename, policyname, permissive, roles, cmd, qual, with_check
-- FROM pg_policies
-- WHERE tablename = 'products';

-- -----------------------------------------------------------------------------
-- 원복 SQL (Rollback SQL)
-- -----------------------------------------------------------------------------
-- DROP POLICY IF EXISTS "products_insert_authenticated" ON public.products;
